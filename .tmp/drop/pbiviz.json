{"visual":{"name":"OrganizationPasswordFilter","displayName":"Organization Password Filter","guid":"organizationPasswordFilter1234567890ABCDEF","visualClassName":"OrganizationPasswordFilter","version":"1.0.0.0","description":"A custom visual that prompts for a password and filters data by organization","supportUrl":"https://github.com","gitHubUrl":""},"author":{"name":"Power BI Developer","email":"developer@example.com"},"apiVersion":"5.3.0","style":"style/visual.less","stringResources":{},"capabilities":{"dataRoles":[{"displayName":"Data","name":"data","kind":"Grouping"},{"displayName":"Organization","name":"organization","kind":"Grouping"}],"dataViewMappings":[{"table":{"rows":{"for":{"in":"data"},"dataReductionAlgorithm":{"top":{}}},"columns":{"select":[{"bind":{"to":"organization"}}]}}}],"objects":{"passwordSettings":{"displayName":"Password Settings","properties":{"password":{"displayName":"Password","type":{"text":true}},"showPassword":{"displayName":"Show Password","type":{"bool":true}}}},"filterSettings":{"displayName":"Filter Settings","properties":{"organizationMapping":{"displayName":"Organization Password Mapping","type":{"text":true},"description":"JSON mapping: {\"password1\":\"FAO\",\"password2\":\"UNICEF\"}"}}}},"supportsEmptyDataView":true,"supportsMultiVisualSelection":false,"supportsSynchronizingFilterState":true,"privileges":[]},"content":{"js":"var organizationPasswordFilter1234567890ABCDEF;(()=>{\"use strict\";var e={639:(e,t,s)=>{function i(e,t){return{objectName:e,propertyName:t.name,selector:t.selector,altConstantValueSelector:t.altConstantSelector,instanceKind:t.instanceKind}}function a(e,t,s){return null==t||\"object\"==typeof t&&!t.solid?s:t.solid?{value:null==t?void 0:t.solid.color}:(null==e?void 0:e.items)?e.items.find(e=>e.value==t):t}s.d(t,{D:()=>a,y:()=>i})},667:(e,t,s)=>{s.d(t,{A:()=>i});const i=class{constructor(e){this.localizationManager=e}populateFormattingSettingsModel(e,t){var s,i,a;let o=new e,r=null===(i=null===(s=null==t?void 0:t[0])||void 0===s?void 0:s.metadata)||void 0===i?void 0:i.objects;return r&&(null===(a=o.cards)||void 0===a||a.forEach(e=>{var t,s,i;null===(t=null==e?void 0:e.slices)||void 0===t||t.forEach(t=>{null==t||t.setPropertiesValues(r,e.name)}),null===(i=null===(s=null==e?void 0:e.container)||void 0===s?void 0:s.containerItems)||void 0===i||i.forEach(t=>{var s;null===(s=null==t?void 0:t.slices)||void 0===s||s.forEach(t=>{null==t||t.setPropertiesValues(r,e.name)})})})),o}buildFormattingModel(e){var t;let s={cards:[]};return null===(t=e.cards)||void 0===t||t.forEach(e=>{if(!e)return;const t=e.name,i=e.name+\"-group\";let a={displayName:void 0,slices:[],uid:i},o=e.getFormattingCard(t,a,this.localizationManager);s.cards.push(o);const r={};if(e.container){const s=e.container,n=i+\"-container\",l={displayName:this.localizationManager&&s.displayNameKey?this.localizationManager.getDisplayName(s.displayNameKey):s.displayName,description:this.localizationManager&&s.descriptionKey?this.localizationManager.getDisplayName(s.descriptionKey):s.description,containerItems:[],uid:n};s.containerItems.forEach(e=>{const s=e.displayNameKey?e.displayNameKey:e.displayName,i=n+s;let a={displayName:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,slices:[],uid:i};this.buildFormattingSlices(e.slices,t,r,o,a.slices),l.containerItems.push(a)}),a.container=l}e.slices&&this.buildFormattingSlices(e.slices,t,r,o,a.slices),o.revertToDefaultDescriptors=this.getRevertToDefaultDescriptor(e)}),s}buildFormattingSlices(e,t,s,i,a){null==e||e.forEach(e=>{let o=null==e?void 0:e.getFormattingSlice(t,this.localizationManager);o&&(void 0===s[e.name]?s[e.name]=0:(s[e.name]++,o.uid=`${o.uid}-${s[e.name]}`),e.topLevelToggle?(o.suppressDisplayName=!0,i.topLevelToggle=o):a.push(o))})}getRevertToDefaultDescriptor(e){var t,s;const i={};let a=[],o=this.getSlicesRevertToDefaultDescriptor(e.name,e.slices,i),r=[];return null===(s=null===(t=e.container)||void 0===t?void 0:t.containerItems)||void 0===s||s.forEach(t=>{r=r.concat(this.getSlicesRevertToDefaultDescriptor(e.name,t.slices,i))}),a=o.concat(r),a}getSlicesRevertToDefaultDescriptor(e,t,s){let i=[];return null==t||t.forEach(t=>{t&&!s[t.name]&&(s[t.name]=!0,i=i.concat(t.getRevertToDefaultDescriptor(e)))}),i}}},674:(e,t,s)=>{s.d(t,{O:()=>a.A,z:()=>i});var i=s(754),a=s(667)},754:(e,t,s)=>{s.d(t,{Kx:()=>o,Zp:()=>r,jF:()=>l,ks:()=>c});var i=s(639);class a{}class o{}class r extends a{getFormattingCard(e,t,s){return{displayName:s&&this.displayNameKey?s.getDisplayName(this.displayNameKey):this.displayName,description:s&&this.descriptionKey?s.getDisplayName(this.descriptionKey):this.description,groups:[t],uid:e,analyticsPane:this.analyticsPane}}}class n extends a{constructor(e){super(),Object.assign(this,e)}getFormattingSlice(e,t){const s=this.type,i=this.name,a={displayName:t&&this.displayNameKey?t.getDisplayName(this.displayNameKey):this.displayName,description:t&&this.descriptionKey?t.getDisplayName(this.descriptionKey):this.description,uid:e+\"-\"+i};return Object.assign(Object.assign({},a),{control:{type:s,properties:this.getFormattingComponent(e,t)}})}getFormattingComponent(e,t){return{descriptor:i.y(e,this),value:this.value}}getRevertToDefaultDescriptor(e){return[{objectName:e,propertyName:this.name}]}setPropertiesValues(e,t){var s;let a=null===(s=null==e?void 0:e[t])||void 0===s?void 0:s[this.name];this.value=i.D(this,a,this.value)}}class l extends n{constructor(e){super(e),this.type=\"ToggleSwitch\"}}class c extends n{constructor(e){super(e),this.type=\"TextInput\"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{placeholder:this.placeholder})}}},789:(e,t,s)=>{s.d(t,{v:()=>o});var i=s(674),a=s(980);class o{constructor(e){if(this.currentOrganization=null,this.allData=[],this.viewModel={dataPoints:[]},this.currentDataView=null,!e)throw new Error(\"VisualConstructorOptions is required\");this.host=e.host,this.element=e.element,this.formattingSettingsService=new i.O;const t=document.createElement(\"div\");t.className=\"passwordFilterContainer\";const s=document.createElement(\"div\");s.className=\"passwordSection\",this.passwordInput=document.createElement(\"input\"),this.passwordInput.type=\"password\",this.passwordInput.className=\"passwordInput\",this.passwordInput.placeholder=\"Enter password\",this.submitButton=document.createElement(\"button\"),this.submitButton.textContent=\"Enter\",this.submitButton.className=\"submitButton\",this.messageDiv=document.createElement(\"div\"),this.messageDiv.className=\"messageDiv\",s.appendChild(this.passwordInput),s.appendChild(this.submitButton),s.appendChild(this.messageDiv),t.appendChild(s),this.element.appendChild(t),this.submitButton.addEventListener(\"click\",()=>this.handlePasswordSubmit()),this.passwordInput.addEventListener(\"keypress\",e=>{\"Enter\"===e.key&&this.handlePasswordSubmit()})}update(e){this.formattingSettings=this.formattingSettingsService.populateFormattingSettingsModel(a.S,e.dataViews);const t=e.dataViews[0];if(!t||!t.table)return void this.blockAllData();this.currentDataView=t;const s=t.table,i=s.rows;if(!i||0===i.length)return void this.blockAllData();const o=s.columns.map(e=>e.displayName||e.queryName);this.allData=i.map(e=>{const t={};return o.forEach((s,i)=>{t[s]=e[i]}),t});const r=s.columns.findIndex(e=>{const t=(e.displayName||e.queryName||\"\").toLowerCase();return t.includes(\"organization\")||t.includes(\"org\")});this.viewModel.dataPoints=i.map((e,t)=>{const i=r>=0?String(e[r]||\"\"):\"\",a=this.host.createSelectionIdBuilder();let o;return s.identity&&s.identity[t]?o=s.identity[t]:r>=0&&s.columns[r]?(a.withTable(s,t),o=a.createSelectionId()):o=a.createSelectionId(),{identity:o,org:i,...this.allData[t]}}),this.currentOrganization?this.applyFilter(this.currentOrganization):this.blockAllData()}handlePasswordSubmit(){var e,t,s;const i=this.passwordInput.value.trim();if(console.log(\"[PasswordFilter] Password submitted:\",i),!i)return this.showMessage(\"Please enter a password\",\"error\"),this.currentOrganization=null,void this.blockAllData();const a=(null===(s=null===(t=null===(e=this.formattingSettings)||void 0===e?void 0:e.filterSettings)||void 0===t?void 0:t.organizationMapping)||void 0===s?void 0:s.value)||this.getDefaultPasswordMapping();let o;try{o=\"string\"==typeof a?JSON.parse(a):a}catch(e){console.warn(\"[PasswordFilter] Failed to parse mapping JSON, using default:\",e),o=this.getDefaultPasswordMapping()}console.log(\"[PasswordFilter] Password mapping:\",o);const r=o[i];if(!r)return this.showMessage(\"Invalid password\",\"error\"),console.warn(\"[PasswordFilter] Invalid password:\",i),this.currentOrganization=null,void this.blockAllData();console.log(\"[PasswordFilter] Password valid, organization:\",r),this.currentOrganization=r,this.showMessage(\"Access granted\",\"success\"),this.applyFilter(r)}getDefaultPasswordMapping(){return{FAO123:\"FAO\",UNICEF123:\"UNICEF\",UNHCR123:\"UNHCR\",WHO123:\"WHO\",WIPO123:\"WIPO\"}}blockAllData(){try{if(console.log(\"[PasswordFilter] Blocking all data access - no valid password\"),!this.currentDataView||!this.currentDataView.table){const e={$schema:\"http://powerbi.com/product/schema#basic\",target:{},operator:\"None\"};return void this.host.applyJsonFilter(e,\"general\",\"filter\",0)}const e=this.currentDataView.table,t=e.columns.findIndex(e=>{const t=(e.displayName||e.queryName||\"\").toLowerCase();return t.includes(\"organization\")||t.includes(\"org\")});if(t<0){const e={$schema:\"http://powerbi.com/product/schema#basic\",target:{},operator:\"None\"};return void this.host.applyJsonFilter(e,\"general\",\"filter\",0)}const s=e.columns[t],i=s.queryName||s.displayName,a={$schema:\"http://powerbi.com/product/schema#basic\",target:{table:i.split(\".\")[0]||i,column:i.split(\".\").pop()||s.displayName},operator:\"In\",values:[]};console.log(\"[PasswordFilter] Applying blocking filter:\",JSON.stringify(a,null,2)),this.host.applyJsonFilter(a,\"general\",\"filter\",0)}catch(e){console.error(\"[PasswordFilter] Error blocking data:\",e)}}applyFilter(e){try{if(!this.currentDataView||!this.currentDataView.table)return this.showMessage(\"No data view available for filtering\",\"error\"),void console.error(\"[PasswordFilter] No data view available\");const t=this.currentDataView.table,s=t.columns.findIndex(e=>{const t=(e.displayName||e.queryName||\"\").toLowerCase();return t.includes(\"organization\")||t.includes(\"org\")});if(s<0)return this.showMessage(\"Organization column not found\",\"error\"),void console.error(\"[PasswordFilter] Organization column not found in columns:\",t.columns.map(e=>e.displayName||e.queryName));const i=t.columns[s],a=i.queryName||i.displayName,o=a.split(\".\")[0]||a,r=a.split(\".\").pop()||i.displayName;console.log(\"[PasswordFilter] Applying filter:\",{organization:e,tableName:o,columnName:r,queryName:a,displayName:i.displayName});const n={$schema:\"http://powerbi.com/product/schema#basic\",target:{table:o,column:r},operator:\"In\",values:[e]};console.log(\"[PasswordFilter] Filter JSON:\",JSON.stringify(n,null,2)),this.host.applyJsonFilter(n,\"general\",\"filter\",0),console.log(\"[PasswordFilter] Filter applied successfully\")}catch(e){const t=(null==e?void 0:e.message)||String(e);this.showMessage(`Filter error: ${t}`,\"error\"),console.error(\"[PasswordFilter] Filter error:\",e),console.error(\"[PasswordFilter] Error stack:\",null==e?void 0:e.stack)}}showMessage(e,t){this.messageDiv.textContent=e,this.messageDiv.className=`messageDiv ${t}`,\"success\"===t&&setTimeout(()=>{this.messageDiv.textContent=\"\",this.messageDiv.className=\"messageDiv\"},3e3)}getFormattingModel(){return this.formattingSettingsService.buildFormattingModel(this.formattingSettings)}enumerateObjectInstances(e){return[]}}},980:(e,t,s)=>{s.d(t,{S:()=>l});var i=s(674),a=i.z.Zp,o=i.z.Kx;class r extends a{constructor(){super(...arguments),this.password=new i.z.ks({name:\"password\",displayName:\"Password\",value:\"\",placeholder:\"\"}),this.showPassword=new i.z.jF({name:\"showPassword\",displayName:\"Show Password\",value:!1}),this.name=\"passwordSettings\",this.displayName=\"Password Settings\",this.slices=[this.password,this.showPassword]}}class n extends a{constructor(){super(...arguments),this.organizationMapping=new i.z.ks({name:\"organizationMapping\",displayName:\"Organization Password Mapping\",value:JSON.stringify({FAO123:\"FAO\",UNICEF123:\"UNICEF\",UNHCR123:\"UNHCR\",WHO123:\"WHO\",WIPO123:\"WIPO\"},null,2),placeholder:'{\"password1\":\"FAO\",\"password2\":\"UNICEF\"}'}),this.name=\"filterSettings\",this.displayName=\"Filter Settings\",this.slices=[this.organizationMapping]}}class l extends o{constructor(){super(...arguments),this.passwordSettings=new r,this.filterSettings=new n,this.cards=[this.passwordSettings,this.filterSettings]}}}},t={};function s(i){var a=t[i];if(void 0!==a)return a.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,s),o.exports}s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var i={};(()=>{s.r(i),s.d(i,{default:()=>o});var e=s(789),t=window.powerbi,a={name:\"organizationPasswordFilter1234567890ABCDEF\",displayName:\"Organization Password Filter\",class:\"OrganizationPasswordFilter\",apiVersion:\"5.3.0\",create:t=>{if(e.v)return new e.v(t);throw\"Visual instance not found\"},createModalDialog:(e,t,s)=>{const i=globalThis.dialogRegistry;e in i&&new i[e](t,s)},custom:!0};void 0!==t&&(t.visuals=t.visuals||{},t.visuals.plugins=t.visuals.plugins||{},t.visuals.plugins.organizationPasswordFilter1234567890ABCDEF=a);const o=a})(),organizationPasswordFilter1234567890ABCDEF=i})();","css":".organizationPasswordFilter {\n  font-family: 'Segoe UI', wf_segoe-ui_normal, helvetica, arial, sans-serif;\n  font-size: 11px;\n  color: #333333;\n  width: 100%;\n  height: 100%;\n  overflow: auto;\n  box-sizing: border-box;\n}\n.passwordFilterContainer {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: 100%;\n  padding: 10px;\n  box-sizing: border-box;\n}\n.passwordSection {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  padding: 15px;\n  background-color: #f8f9fa;\n  border-radius: 4px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n.passwordInput {\n  padding: 8px 12px;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  font-size: 14px;\n  width: 100%;\n  box-sizing: border-box;\n  transition: border-color 0.3s;\n}\n.passwordInput:focus {\n  outline: none;\n  border-color: #0078d4;\n  box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.2);\n}\n.submitButton {\n  padding: 10px 20px;\n  background-color: #0078d4;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  font-size: 14px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: background-color 0.3s;\n  width: 100%;\n  max-width: 200px;\n}\n.submitButton:hover {\n  background-color: #106ebe;\n}\n.submitButton:active {\n  background-color: #005a9e;\n}\n.messageDiv {\n  padding: 8px 12px;\n  border-radius: 4px;\n  font-size: 13px;\n  min-height: 20px;\n  transition: all 0.3s;\n}\n.messageDiv.success {\n  background-color: #d4edda;\n  color: #155724;\n  border: 1px solid #c3e6cb;\n}\n.messageDiv.error {\n  background-color: #f8d7da;\n  color: #721c24;\n  border: 1px solid #f5c6cb;\n}\n\n","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAE7mlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDIgNzkuYTFjZDEyZiwgMjAyNC8xMS8xMS0xOTowODo0NiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI2LjQgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyNS0xMS0xM1QxNTo0NzoyMyswMTowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjUtMTEtMTNUMTU6NDg6MTArMDE6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMjUtMTEtMTNUMTU6NDg6MTArMDE6MDAiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjEwZDM2MzdjLWYzYzEtOTE0Ni1iZmRiLTJlN2M5ZTU2ZWM1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxMGQzNjM3Yy1mM2MxLTkxNDYtYmZkYi0yZTdjOWU1NmVjNTciIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxMGQzNjM3Yy1mM2MxLTkxNDYtYmZkYi0yZTdjOWU1NmVjNTciPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjEwZDM2MzdjLWYzYzEtOTE0Ni1iZmRiLTJlN2M5ZTU2ZWM1NyIgc3RFdnQ6d2hlbj0iMjAyNS0xMS0xM1QxNTo0NzoyMyswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI2LjQgKFdpbmRvd3MpIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PoEh89oAAAKlSURBVDgRrcHNalxlHMfx7+//PPOSCUmaqaRFo0LdhIqKC1EKQtG6caELQS/AO3Dlxrtw4wW4UfANodBbsAii0oVGrS+FtiYmpnNmzpxznp9pGpJFXc7nk22zSJkFyyxYXlt6nyglhvBam/K6TA0GqSs6ZIfMfVOgBcQpWYxT1+7V6FqJKDkQini8DT1TpB2BMQFMoNClvBR2i8s9oM8pATVS6pSeU+FGwM2cIrC4WNA29ucWuN+DuTdW6lI3Ue/XwwzWK4aBoOGQOTKS/bGVrihxMeyb2Rwy08DITi28E52utd57tUr1VprHRxXz3tpw81Ln9osC4lBAK/t1mxfAfxvOGMiculPE5SRtNHPPkKtZ1J+m4fl3e2XypdxuC/9gc0QSgTc7PAS1HMscM4wL+jbh5ZSa98SZq5mz41B7NQbjX+bd9EV16e0Qc+6zowSbkZY+K23zJHSAyJxaCbFTO32VmnZ3KWbXZ4N+n+I6zWZEyrcMF2SmPJCx7tiTP008DakGkwWYI3symz2Vy85xey694c7fGT/bRF6HOO8gGZY5oiTljYPqk5Vhfmnaz1thV2RzxEALVpgnCNaNCmbdnW4TsRsqQ0zFCaVAqfPO1MwTJBvIB3VmddhUoFSgCP0DTDFkeUTSqnEpUCRlTjjZ9HI82oYGU6ntDmaJ3Au2QsO3XGoJKvA6YMCYMB4LJDMHByeEfVBWBm9+INIjhcl+inw3rw2656vuj5JiY1dO55D3AQEjW7+DPgTzEIUbJo/JXMH+PpflC+N+eynP2u2fC2xlemHKX1gc25eowU+Zh4mOrHOjrvv3VleqUcTqtFc3N3LVXP9t1Hv5m1yWJsX3ZoB4oAMGwFn+lwHP5d6PSaNRSa3c8GuetT/dBb5mQTILllmw/wCVXlnNq1lDwQAAAABJRU5ErkJggg=="},"visualEntryPoint":""}